"use strict"; !function (e) { var t, n, a = e(); e.fn.sortable = function (i) { var r = String(i); return i = e.extend({ connectWith: !1, placeholder: null, dragImage: null }, i), this.each(function () { "refresh" === r && e(this).children(i.items).off("dragstart.h5s dragend.h5s selectstart.h5s dragover.h5s dragenter.h5s drop.h5s"); var o = e(this).data("opts"); "undefined" == typeof o ? e(this).data("opts", i) : i = o; var s, c, l, d, u = e(this).children(i.items), h = null === i.placeholder ? e("<" + (/^ul|ol$/i.test(this.tagName) ? "li" : "div") + ' class="sortable-placeholder">') : e(i.placeholder).addClass("sortable-placeholder"); u.find(i.handle).mousedown(function () { s = !0 }).mouseup(function () { s = !1 }), e(this).data("items", i.items), a = a.add(h), i.connectWith && e(i.connectWith).add(this).data("connectWith", i.connectWith), u.attr("role", "option"), u.attr("aria-grabbed", "false"), u.attr("draggable", "true").on("dragstart.h5s", function (a) { if (a.stopImmediatePropagation(), i.handle && !s) { return !1 } s = !1; var r = a.originalEvent.dataTransfer; r.effectAllowed = "move", r.setData("text", ""), i.dragImage && r.setDragImage && r.setDragImage(i.dragImage, 0, 0), c = (t = e(this)).addClass("sortable-dragging").attr("aria-grabbed", "true").index(), n = t.outerHeight(), l = e(this).parent() }).on("dragend.h5s", function () { t && (t.removeClass("sortable-dragging").attr("aria-grabbed", "false").show(), a.detach(), d = e(this).parent(), (c !== t.index() || l.get(0) !== d.get(0)) && t.parent().triggerHandler("sortupdate", { item: t, oldindex: c, startparent: l, endparent: d }), t = null, n = null) }).not("a[href], img").on("selectstart.h5s", function () { return i.handle && !s ? !0 : (this.dragDrop && this.dragDrop(), !1) }).end().add([this, h]).on("dragover.h5s dragenter.h5s drop.h5s", function (r) { if (!u.is(t) && i.connectWith !== e(t).parent().data("connectWith")) { return !0 } if ("drop" === r.type) { return r.stopPropagation(), a.filter(":visible").after(t), t.trigger("dragend.h5s"), !1 } if (r.preventDefault(), r.originalEvent.dataTransfer.dropEffect = "move", u.is(this)) { var o = e(this).outerHeight(); if (i.forcePlaceholderSize && h.height(n), o > n) { var s = o - n, c = e(this).offset().top; if (h.index() < e(this).index() && r.originalEvent.pageY < c + s) { return !1 } if (h.index() > e(this).index() && r.originalEvent.pageY > c + o - s) { return !1 } } t.hide(), e(this)[h.index() < e(this).index() ? "after" : "before"](h), a.not(h).detach() } else { a.is(this) || e(this).children(i.items).length || (a.detach(), e(this).append(h)) } return !1 }) }) } } (jQuery), function () { var e, t, n, a, i, r, o, s, c, l, d, u, h, p, f, g, v, m, b, k; return t = $(document), l = $(".event-create-add-label-modal"), c = $(".event-create-add-label-list ul"), h = $(".icon-event-create-place"), e = $("#baidumapContainer"), t.on("click", ".create-event-label", function (e) { return e.preventDefault(), e.stopPropagation(), l.toggleClass("hide") }), t.on("click.off.modal", function (t) { var n; return n = $(t.target), n.hasClass("create-event-label") || n.hasClass("icon-event-label-add") || l.addClass("hide"), n.hasClass("BaiDuMap") || n.hasClass("BMap_mask") || n.hasClass("BMap_Marker") ? void 0 : e.hide() }), v = { count: c.find("li").length }, l.on("click", "li", function (e) { var t, n; return e.stopPropagation(), n = $(this), n.hasClass("active") || v.count >= 5 ? void 0 : (n.addClass("active"), v[n.html()] = n, v.count++, t = $('<li class="fade">\n  ' + $(this).html() + '<span class="icon-close"></span>\n</li>').appendTo(c), setTimeout(function () { return t.addClass("in") }, 0)) }), c.on("click", "li", function (e) { return e.stopPropagation() }), c.on("click", ".icon-close", function (e) { var t; return e.stopPropagation(), t = $(this).alert("close").parent().text().trim(), v[t] && v[t].removeClass("active"), v.count-- }), $(".event-create-place-input").tooltip({ trigger: "focus" }).focus(function () { return locAddress(!0) }).click(function (e) { return e.stopPropagation() }), k = '<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>', $(".icon-event-create-alert").each(function () { var e; return e = $(this).next(".sr-only").html(), $(this).tooltip({ placement: $(this).data("placement") || "right", html: e ? !0 : !1, title: e, template: e ? k.replace("tooltip-inner", "tooltip-inner tooltip-inner-multi") : k }) }), d = $("#event_ticket_fee_prompt"), u = d.next(".sr-only").html(), d.popover({ trigger: "hover", html: !0, content: u }), h.on("click", function (t) { return t.stopPropagation(), e.is(":visible") ? e.hide() : locAddress(!0) }), $(".event-create-sign-select").on("click", ".icon-close", function () { return $(this).parent().remove() }).find(".create-event-label").click(function (e) { return e.preventDefault(), $(this).before('<div>\n  <input type="text" class="form-control">\n  <span class="icon-close"></span>\n</div>') }), p = $(".event-create-payment"), p.on("click", "label", function (e) { var t, n; return e.preventDefault(), t = $(this), n = t.find("input")[0], p.data("radioActive") ? t.hasClass("active") || t.toggleClass("active").siblings().toggleClass("active") : (t.addClass("active"), p.data("radioActive", !0)), n.checked = !0, showUserPaymentInfo ? showUserPaymentInfo(n.getAttribute("paymentType")) : void 0 }), $(".icon-refresh-code").click(function () { return $(this).hasClass("active") !== !0 ? ($(this).addClass("active"), setTimeout(function (e) { return function () { return $(e).removeClass("active") } } (this), 300)) : void 0 }), b = function (e) { var t; return e.toggleClass("event-create-ticket-edit").find("th input").attr("disabled", !e.hasClass("event-create-ticket-edit")), e.data("js-input") ? void 0 : (-1 === navigator.userAgent.indexOf("MSIE") ? e.find("select").selectpicker() : $.browser.msie && +$.browser.version < 9 ? e.find("select").addClass("form-control") : (t = e.find("select").toArray(), yieldingChunk(t, function (e) { return $(e).selectpicker() }, void 0, 100)), e.find(".form-group-date input").datepicker({ format: "yyyy/mm/dd" }), e.data("js-input", !0)) }, $(".icon-event-ticket-alert").tooltip({ placement: "right", container: "body" }), t.on("click", ".event-create-ticket .event-create-ticket-edit-toggle", function (e) { return b($(e.currentTarget).parents(".event-create-ticket")) }), t.on("change.ticketStatus", ".label-include-input input", function (e) { var t; return t = $(this).parents(".event-create-ticket").find("[class^=text-]"), this.checked ? t.removeClass("text-muted").addClass("text-danger").html("已停售") : t.removeClass("text-danger").addClass("text-muted").html("售票尚未开始") }), $(".event-create-form-more").on("click", "h3", function (e) { return $(e.delegateTarget).toggleClass("open") }), $(".form-group-date").length && $(".form-group-date input").datepicker({ format: "yyyy/mm/dd" }), n = $(".event-create-add-item"), a = n.next(), n.click(function () { return $(this).addClass("hide"), a.removeClass("hide") }), m = 0, $("#event-create-item-toggle").click(function () { return a.addClass("hide"), n.removeClass("hide"), t.scrollTop(n.offset().top - m - 35) }), $("#event_template_form_items").sortable({ forcePlaceholderSize: !0 }), $("#event_template_form_items").on("mouseenter", ".form-group", function (e) { var t; return t = $(this), e.offsetX < 30 ? (t.data("bs.tooltip") || t.tooltip({ placement: "left", title: "拖动栏目排序", container: t, trigger: "manual" }), t.tooltip("show")) : void 0 }).on("mouseleave", ".form-group", function (e) { return $(this).data("bs.tooltip") ? $(this).tooltip("hide") : void 0 }) } (this), function () { var e, t, n, a, i, r, o, s, c, l; return a = $(document), c = 0, $(".event-admin-ticket-class li").each(function () { var e, t, n, a, i; return e = $(this).find(".progress-bar"), i = $(this).find("span"), e.length ? (a = e.attr("aria-valuenow") / e.attr("aria-valuemax") * 100, 1 > a && a > 0 ? a = 1 : a > 100 && (a = 100), e.css("width", a + "%"), n = a / 100 * 370, t = 100 === a ? -i.width() + 2 : -i.width() / 2, i.css({ marginLeft: n > 50 ? t + n : 50 })) : i.css("marginLeft", 50) }), s = function (e, t, n) { var a; return a = new ZeroClipboard(e), a.on("aftercopy", function (a) { return $(e).tooltip({ title: "已复制", trigger: "manual", placement: t ? t : "top" }).tooltip("show"), setTimeout(function () { return $(e).tooltip("hide") }, 1000), "function" == typeof n && n() }) }, window.clipText = s, i = $(".event-admin-short-url .text-primary"), $.browser.msie && +$.browser.version < 9 ? i.hide() : i.each(function () { return s(this, "right") }), e = $(".event-admin-nav"), e.length && e.affix({ offset: { top: e.offset().top - c - 30, bottom: $(".page-footer").outerHeight(!0) + 60} }), r = $(".event-create-org-card"), o = $("#event-create-organizer .event-create-form"), l = function () { return o.toggle(), r.toggle(), a.scrollTop(250) }, window.toggleOrgCard = l, r.on("click", ".icon-create-config", l), o.find(".btn-create-default").click(l), $("#event-create-organizer .btn-create-add-primary").click(function () { return o.is(":visible") ? void 0 : (o.show(), r.hide()) }), t = $(".event-admin-clearing-info"), n = $(".event-admin-clearing-info > div"), t.find("h3").click(function () { return n.slideToggle(function () { return t.toggleClass("open"), setTimeout(function () { return e.trigger("click") }, 3000) }) }) } (this);